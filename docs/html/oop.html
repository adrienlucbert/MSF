

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Programmation orientée objet &mdash; MSF 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="ll.html" />
    <link rel="prev" title="Documentation MSF" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> MSF
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Programmation orientée objet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#la-poo-quoi-c-est">La POO? Quoi c’est?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mieux-avec-un-exemple">Mieux avec un exemple…</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notion-d-heritage">Notion d’héritage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ca-donne-quoi-en-c">Ca donne quoi en C?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hub.html">Game Hub</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MSF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Programmation orientée objet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/oop.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="programmation-orientee-objet">
<h1>Programmation orientée objet<a class="headerlink" href="#programmation-orientee-objet" title="Permalink to this headline">¶</a></h1>
<div class="section" id="la-poo-quoi-c-est">
<h2>La POO? Quoi c’est?<a class="headerlink" href="#la-poo-quoi-c-est" title="Permalink to this headline">¶</a></h2>
<p>La programmation orientée objet est une méthode de développement très prisée ces
dernières années. On appelle objet une entité définie par des données (simples
variables appelées propriétés), et des fonctions (appelées méthodes).
La classe est la définition d’un type d’objet. Ainsi, chaque objet est une
instance de la classe dont il dépend.</p>
<div class="section" id="mieux-avec-un-exemple">
<h3>Mieux avec un exemple…<a class="headerlink" href="#mieux-avec-un-exemple" title="Permalink to this headline">¶</a></h3>
<p>Dans un RPG, on définit un personnage, entre autres, par son nom et ses points
de vie.</p>
<p>On aura donc la classe (ou class en anglais) Personnage, qui aura comme
propriétés :</p>
<blockquote>
<div><ul class="simple">
<li>nom</li>
<li>pts_vie</li>
</ul>
</div></blockquote>
<div class="admonition-remember admonition">
<p class="first admonition-title">Remember</p>
<p class="last">Par convention, le nom d’une classe commence par une majuscule.</p>
</div>
<p>Ensuite, un personnage peut effectuer différentes actions, parmi lesquelles
attaquer.</p>
<p>On peut donc compléter notre classe avec ses méthodes :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>class Personnage:
    # properties
    nom
    pts_vie

    # methods
    attaquer(cible)
</pre></div>
</div>
<p>Notre programme sait maintenant ce qu’est qu’un personnage, on peut lui
demander d’en créer!</p>
<div class="admonition-tips admonition">
<p class="first admonition-title">Tips</p>
<p class="last">La plupart des langages orientés objet utilisent le mot-clé <strong>new</strong> pour
créer une instance d’une classe (donc un objet).</p>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dovahkiin = new Personnage(nom = &quot;Dovahkiin&quot;, pts_vie = 100)
alduin = new Personnage(nom = &quot;Alduin&quot;, pts_vie = 3000)

dovahkiin-&gt;attaquer(alduin)
alduin-&gt;attaquer(dovahkiin)
</pre></div>
</div>
<p>On a ainsi créé deux instances de la classe Car, deux objets ayant en commun
leur définition, mais dont les propriétés ont des valeurs différentes.
Chaque instance peut évoluer indépendemment des autres.</p>
</div>
<div class="section" id="notion-d-heritage">
<h3>Notion d’héritage<a class="headerlink" href="#notion-d-heritage" title="Permalink to this headline">¶</a></h3>
<p>Une dernière notion à aborder avant de rentrer dans le vif du sujet: l’héritage.
Plusieurs classes peuvent être très proches, avoir seulement quelques
propriétés ou méthodes différant.
À ce moment là, on utilise l’héritage. On définit une classe qui réunit les
propriétés et méthodes communes aux autres classes qu’on appelera les enfants,
puis on définit les enfants, avec seulement les propriétés et méthodes qui leur
sont propres. On précise alors que les classes enfant <strong>héritent</strong> de la classe
parent, à l’aide d’un mot clé, souvent <code class="docutils literal notranslate"><span class="pre">extends</span></code>.</p>
<p>Prenons l’exemple de personnages de RPG:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>class Personnage:
    # properties
    nom
    pts_vie

    # methods
    attaquer(cible)

class Hero extends Personnage:
    # properties
    pts_mana

    # methods
    soigner()

class Gobelin extends Personnage
    # properties
    nom = &quot;Gobelin&quot; // valeur par défaut pour la propriété nom
    nom_clan

    # methods
    grogner();
</pre></div>
</div>
</div>
<div class="section" id="ca-donne-quoi-en-c">
<h3>Ca donne quoi en C?<a class="headerlink" href="#ca-donne-quoi-en-c" title="Permalink to this headline">¶</a></h3>
<p>Le C n’est pas connu pour être un langage orienté objet… Et pour cause, le C
n’offre aucun support du concept d’objet. Il est en revanche possible de s’en
approcher en adoptant certaines pratiques.</p>
<p>Vous l’aurez sûrement deviné, on va utiliser des structures pour représenter
les classes. Les différentes variables seront les propriétés, et il suffira
de créer des pointeurs sur fonction pour simuler des méthodes.</p>
<p>On aura des constructeurs (constructor en anglais, abrégé ctor), une fonction
pour chaque classe, destinée à initialiser les propriétés et méthodes d’un
objet. Parallèlement, on aura des destructeurs (destructor, abrégé dtor)
pour chaque classe, destiné à “vider” l’objet, soit désallouer l’espace mémoire
réservé pour ses propriétés.
Le <code class="docutils literal notranslate"><span class="pre">ctor</span></code> et le <code class="docutils literal notranslate"><span class="pre">dtor</span></code> seront accompagnés d’une fonction <code class="docutils literal notranslate"><span class="pre">new</span></code>, qui prend
la place du mot-clé “new” évoqué précédemment, et d’une fonction <code class="docutils literal notranslate"><span class="pre">destroy</span></code>.
Le rôle de la fonction new sera d’allouer l’espace mémoire nécessaire pour
stocker l’objet (malloc la structure), et appeler le ctor correspondant.
Le rôle de la fonction destroy sera d’appeler le dtor correspondant, puis
de désallouer l’espace mémoire réservé pour l’objet (free la structure).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* HEADER */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">personnage_s</span> <span class="n">personnage_t</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">personnage_attaquer</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">personnage_s</span> <span class="p">{</span>
    <span class="cp"># properties</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">nom</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">pts_vie</span><span class="p">;</span>

    <span class="cp"># methods</span>
    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">attaquer</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cible</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* /HEADER */</span>

<span class="kt">void</span> <span class="o">*</span><span class="n">personnage_new</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">nom</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pts_vie</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">personnage_t</span> <span class="o">*</span><span class="n">st_personnage</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">personnage_t</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">st_personnage</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
    <span class="n">personnage_ctor</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">st_personnage</span><span class="p">,</span> <span class="n">nom</span><span class="p">,</span> <span class="n">pts_vie</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">st_personnage</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">personnage_ctor</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">personnage</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">nom</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pts_vie</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">personnage_t</span> <span class="o">*</span><span class="n">st_personnage</span> <span class="o">=</span> <span class="p">(</span><span class="n">personnage_t</span> <span class="o">*</span><span class="p">)</span><span class="n">personnage</span><span class="p">;</span>

    <span class="c1">// properties</span>
    <span class="n">st_personnage</span><span class="o">-&gt;</span><span class="n">nom</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="n">nom</span><span class="p">);</span>
    <span class="n">st_personnage</span><span class="o">-&gt;</span><span class="n">pts_vie</span> <span class="o">=</span> <span class="n">pts_vie</span><span class="p">;</span>

    <span class="c1">// methods</span>
    <span class="n">st_personnage</span><span class="o">-&gt;</span><span class="n">attaquer</span> <span class="o">=</span> <span class="n">personnage_attaquer</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">personnage_dtor</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">personnage</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">personnage_t</span> <span class="o">*</span><span class="n">st_personnage</span> <span class="o">=</span> <span class="p">(</span><span class="n">personnage_t</span> <span class="o">*</span><span class="p">)</span><span class="n">personnage</span><span class="p">;</span>

    <span class="n">free</span><span class="p">(</span><span class="n">st_personnage</span><span class="o">-&gt;</span><span class="n">nom</span><span class="p">);</span>
    <span class="c1">// les autres propriétés et les méthodes n&#39;ont pas été malloc</span>
    <span class="c1">// pas besoin de les free</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">personnage_destroy</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">personnage</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">personnage_dtor</span><span class="p">(</span><span class="n">personnage</span><span class="p">);</span>
    <span class="n">free</span><span class="p">(</span><span class="n">personnage</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Vous aurez remarqué qu’on passe passe les objets en <strong>void *</strong>. Ce trick nous
servira à implémenter un système d’héritage. En effet, on pourra par exemple
utiliser les ctor et dtor de la classe Personnage sur une structure enfant,
qui a entre autres les propriétés de la classe Personnage, mais qui n’est pas
de type personnage_t!
Voici donc comment implémenter la classe Gobelin (on ne fera pas Hero, pour
simplifier et raccourcir ce tutoriel), héritant de la classe Personnage.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* HEADER */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">gobelin_s</span> <span class="n">gobelin_t</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">personnage_attaquer</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">gobelin_grogner</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">gobelin_s</span> <span class="p">{</span>
    <span class="cp"># own properties</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">nom_clan</span><span class="p">;</span>

    <span class="cp"># own methods</span>
    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">grogner</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>

    <span class="cp"># properties inherited from personnage_t</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">nom</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">pts_vie</span><span class="p">;</span>

    <span class="cp"># methods inherited from personnage_t</span>
    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">attaquer</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">cible</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* /HEADER */</span>

<span class="kt">void</span> <span class="o">*</span><span class="n">gobelin_new</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">nom_clan</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pts_vie</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">gobelin_t</span> <span class="o">*</span><span class="n">st_gobelin</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">gobelin_t</span><span class="p">));</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">st_gobelin</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
    <span class="n">gobelin_ctor</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">st_gobelin</span><span class="p">,</span> <span class="n">nom_clan</span><span class="p">,</span> <span class="n">pts_vie</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">st_gobelin</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">gobelin_ctor</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">gobelin</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">nom_clan</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pts_vie</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">gobelin_t</span> <span class="o">*</span><span class="n">st_gobelin</span> <span class="o">=</span> <span class="p">(</span><span class="n">gobelin_t</span> <span class="o">*</span><span class="p">)</span><span class="n">gobelin</span><span class="p">;</span>

    <span class="c1">// on appelle le ctor de la classe parent (personnage)</span>
    <span class="n">personnage_ctor</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">st_gobelin</span><span class="p">,</span> <span class="s">&quot;Gobelin&quot;</span><span class="p">,</span> <span class="n">pts_vie</span><span class="p">);</span>

    <span class="c1">// own properties</span>
    <span class="n">st_gobelin</span><span class="o">-&gt;</span><span class="n">nom_clan</span> <span class="o">=</span> <span class="n">strdup</span><span class="p">(</span><span class="n">nom_clan</span><span class="p">);</span>

    <span class="c1">// own methods</span>
    <span class="n">st_gobelin</span><span class="o">-&gt;</span><span class="n">grogner</span> <span class="o">=</span> <span class="n">gobelin_grogner</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">gobelin_dtor</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">gobelin</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">gobelin_t</span> <span class="o">*</span><span class="n">st_gobelin</span> <span class="o">=</span> <span class="p">(</span><span class="n">gobelin_t</span> <span class="o">*</span><span class="p">)</span><span class="n">gobelin</span><span class="p">;</span>

    <span class="n">free</span><span class="p">(</span><span class="n">st_gobelin</span><span class="o">-&gt;</span><span class="n">nom_clan</span><span class="p">);</span>

    <span class="c1">// on appelle le dtor de la classe parent (personnage)</span>
    <span class="n">personnage_dtor</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">st_gobelin</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">gobelin_destroy</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">gobelin</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">gobelin_dtor</span><span class="p">(</span><span class="n">gobelin</span><span class="p">);</span>
    <span class="n">free</span><span class="p">(</span><span class="n">gobelin</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>À partir de là, on peut créer des instances de nos classes à volonté.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">personnage_t</span> <span class="o">*</span><span class="n">legolas</span> <span class="o">=</span> <span class="n">personnage_new</span><span class="p">(</span><span class="s">&quot;Legolas&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">gobelin_t</span> <span class="o">*</span><span class="n">goblin</span> <span class="o">=</span> <span class="n">gobelin_new</span><span class="p">(</span><span class="s">&quot;Zigarouille&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>

<span class="n">legolas</span><span class="o">-&gt;</span><span class="n">attaquer</span><span class="p">(</span><span class="n">goblin</span><span class="p">);</span>
<span class="n">goblin</span><span class="o">-&gt;</span><span class="n">grogner</span><span class="p">();</span>
<span class="n">goblin</span><span class="o">-&gt;</span><span class="n">attaquer</span><span class="p">(</span><span class="n">legolas</span><span class="p">);</span>

<span class="n">personnage_destroy</span><span class="p">(</span><span class="n">legolas</span><span class="p">);</span>
<span class="n">gobelin_destroy</span><span class="p">(</span><span class="n">goblin</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ll.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Documentation MSF" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Adrien Lucbert

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>